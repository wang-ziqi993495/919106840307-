include "booksearchlink.h"
#include "ui_booksearchlink.h"
#include<QDebug>
BookSearchLink::BookSearchLink(QWidget *parent) :
    QDialog(parent),
    ui(new Ui::BookSearchLink)
{
    ui->setupUi(this);
    ui->lineEdit->setEchoMode(QLineEdit::PasswordEchoOnEdit);
    connect(ui->searchBtn,SIGNAL(clicked(bool)),this,SLOT(searchBtnSlot()));
    connect(ui->exitBtn,SIGNAL(clicked(bool)),this,SLOT(exitBtnSlot()));
    this->setWindowTitle("查询订单");
    QPalette p;
    p.setBrush(QPalette::Background,QBrush(QPixmap(":/image/images/2.jpg")));
    this->setPalette(p);
}

BookSearchLink::~BookSearchLink()
{
    delete ui;
}
void BookSearchLink::searchBtnSlot()
{
    model=new QSqlTableModel;
    model->setTable("order_information");
    model->select();
int i=0;
    for( i=0;i<model->rowCount();i++)
    {
        record=model->record(i);
        if(ui->lineEdit->text()==record.value("ID").toString().right(6))
        {
            qDebug()<<record.value("ID").toString();
            booksearch=new BookSearch;
            connect(this,SIGNAL(searchSignal(QString)),booksearch,SLOT(searchSlot(QString)));
            emit searchSignal(ui->lineEdit->text());

        booksearch->show();
        break;
        }
    }
    if(i==model->rowCount())
    {
        QMessageBox::information(this,"提示","没有此人的信息,请重新输入",QMessageBox::Yes);
       ui->lineEdit->clear();
    }

}
void BookSearchLink::exitBtnSlot(){
    this->close();
    delete this;
}
